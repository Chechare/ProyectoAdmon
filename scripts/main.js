"use strict";function validateFlow(e){var t=$("#"+e.data);t.val()?isNaN(parseFloat(t.val()))?(Materialize.toast("Invalid value for cashflow!",3e3),t.val(0)):t.val(parseFloat(t.val())):t.val(0)}function validateInterest(e){var t=document.getElementById(e.data);""==t.value&&(t.value="0"),isNaN(parseInt(t.value))?(Materialize.toast("Please, put a valid integer as the interest.",3e3),t.value="0"):(parseInt(t.value)<0||parseInt(t.value,10)>100)&&(Materialize.toast("You have to choose an interest percentage between 0 - 100.",3e3),t.value="0"),t.value=parseInt(t.value)}function validatePrincipal(e){var t=document.getElementById(e.data);""==t.value&&(t.value=0),isNaN(parseFloat(t.value))?(Materialize.toast("Please, put a valid number as the Principal",3e3),t.value="0"):parseFloat(t.value)<0&&(Materialize.toast("Please, put a positive number",3e3),t.value="0"),t.value=parseFloat(t.value)}function drawPaybackTable(){for(var e=document.getElementById("periodo-select"),t=document.getElementById("pp-table-content"),l='<div class="row  white-text red lighten-2 center-align"> <div class="col l2 md2"><h5> Period</h5></div><div class="col l3 md3"><h5> Outflow </h5></div><div class="col l3 md3"><h5> Inflow </h5></div><div class="col l4 md4"><h5> Cumulative Cash Flow</h5></div></div>';t.firstChild;)t.removeChild(t.firstChild);for(var a=e.options[e.selectedIndex].value,n=1;a>=n;n++)l+="<div class='row'><div class='col l2 md2'><h5 class='center-align'> "+n+"</h5></div><div class='col l3 md3'><input type='text' id='outflow"+n+"' placeholder='$0'></div><div class='col l3 md3'><input type='text' id='inflow"+n+"' placeholder='$0'></div><div class='col l4 md4'><input  type='text' id='cummulative"+n+"' value='$0' readonly></div></div>";t.innerHTML=l;for(var n=1;a>=n;n++)$("#outflow"+n).on("focusout",null,"outflow"+n,validateFlow),$("#inflow"+n).on("focusout",null,"inflow"+n,validateFlow)}function calculate(){var e=document.getElementById("periodo-select"),t=document.getElementById("pp-principal"),l=document.getElementById("pp-interes");if(0==e.options[e.selectedIndex].value)return void Materialize.toast("Select a number of periods and fill the table.",3e3);if("0"==t.value)return void Materialize.toast("The principal has to be greater than 0.",3e3);for(var a=e.options[e.selectedIndex].value,l=document.getElementById("pp-interes").value,n=-1*t.value,o=n,i=1;a>=i;i++){var d=document.getElementById("outflow"+i).value,c=document.getElementById("inflow"+i).value,r=c-d,v=n*l/100;n+=r+v;var s=document.getElementById("cummulative"+i);s.value=n.toFixed(2),0>n?s.style.color="red":s.style.color="black",n>=0&&0>o?s.style.backgroundColor="green":s.style.backgroundColor="white",o=n,$("#pp-print").removeClass("disabled")}}function Clear(){var e=document.getElementById("periodo-select"),t=document.getElementById("pp-principal"),l=document.getElementById("pp-interes");t.value="0",l.value="0";for(var a=e.options[e.selectedIndex].value,a=e.options[e.selectedIndex].value,n=1;a>=n;n++)document.getElementById("outflow"+n).value="",document.getElementById("inflow"+n).value="",document.getElementById("cummulative"+n).value="$0",document.getElementById("cummulative"+n).style.backgroundColor="white",document.getElementById("cummulative"+n).style.color="black";$("#pp-print").addClass("disabled")}function printPaybackPeriod(){var e=$("#pp-table-content"),t=$("#pp-form"),l=(e.width(),new jsPDF({unit:"px",format:"a4"}));l.setFontSize(36),l.text("Payback Period",120,75),html2canvas(e,{imageTimeout:2e3,removeContainer:!0,onrendered:function(e){var a=e.toDataURL("image/png");l.addImage(a,"JPEG",0,150,.4*e.width,.4*e.height),html2canvas(t,{imageTimeout:2e3,removeContainer:!0,onrendered:function(e){var t=e.toDataURL("image/png");l.addImage(t,"JPEG",75,100,.4*e.width,.4*e.height),l.save("Payback.pdf")}})}})}function drawNPVTable(){for(var e=document.getElementById("npv-periodo-select"),t=document.getElementById("npv-content"),l='<div class="row white-text red lighten-2 center-align"><div class="col l1 md1"><h5> Period</h5></div><div class="col l2 md2"><h5> Outflow </h5></div><div class="col l2 md2"><h5> Inflow </h5></div><div class="col l3 md3"><h5> Net Cash Flow</h5></div><div class="col l4 md4"><h5> Cumulative Cash Flow</h5></div></div>;';t.firstChild;)t.removeChild(t.firstChild);for(var a=e.options[e.selectedIndex].value,n=1;a>=n;n++)l+="<div class='row'><div class='col l1 md1'><h5 class=\"center-align\"> "+n+"</h5></div><div class='col l2 md2'><input type='text' id='npv-outflow"+n+"' placeholder='$0'></div><div class='col l2 md2'><input type='text' id='npv-inflow"+n+"' placeholder='$0'></div><div class='col l3 md3'><input  type='text' id='npv-ncf"+n+"' value='$0' readonly></div><div class='col l4 md4'><input  type='text' id='npv-cummulative"+n+"' value='$0' readonly></div></div>";t.innerHTML=l;for(var n=1;a>=n;n++)$("#npv-outflow"+n).on("focusout",null,"npv-outflow"+n,validateFlow),$("#npv-inflow"+n).on("focusout",null,"npv-inflow"+n,validateFlow)}function calculaNPV(){var e=document.getElementById("npv-periodo-select"),t=e.options[e.selectedIndex].value,l=$("#npv-Principal").val(),a=$("#npv-Interes").val(),n=$("#npv-Tax").val();if(0==t)return void Materialize.toast("Select a number of periods and fill the table.",3e3);if(0==l||null==l)return void Materialize.toast("The principal has to be greater than 0.",3e3);for(var o=[],i=[],d=0;t>d;d++)o[d]=$("#npv-inflow"+(d+1)).val(),i[d]=$("#npv-outflow"+(d+1)).val();var c=[],r=[],v=0;n/=100,a/=100;for(var d=0;t>d;d++){c[d]=o[d]-i[d],r[d]=c[d]*(1-n)/Math.pow(1+a,d),v+=r[d];var s=$("#npv-ncf"+(d+1)),u=$("#npv-cummulative"+(d+1));c[d]<0?s.css("color","red"):s.css("color","black"),r[d]<0?u.css("color","red"):u.css("color","black"),s.val(c[d].toFixed(2)),u.val(r[d].toFixed(2)),$("#npv-print").removeClass("disabled")}var p=(v-l).toFixed(2);0>p?$("#npv-result").css("color","red").html("-$ "+Math.abs(p)):$("#npv-result").css("color","black").html("$ "+p)}function clean_npv(){$("#npv-Principal").val(""),$("#npv-Interes").val(""),$("#npv-Tax").val("");for(var e=document.getElementById("npv-periodo-select"),t=e.options[e.selectedIndex].value,l=0;t>l;l++)$("#npv-inflow"+(l+1)).val(""),$("#npv-outflow"+(l+1)).val(""),$("#npv-ncf"+(l+1)).val("$0").css("color","black"),$("#npv-cummulative"+(l+1)).val("$0").css("color","black");$("#npv-result").css("color","black").html("$0"),$("#npv-print").addClass("disabled")}function printNPV(){var e=$("#npv-content"),t=$("#npv-form"),l=$("#npv-result").text(),a=new jsPDF({unit:"px",format:"a4"});a.setFontSize(36),a.text("Net Present Value",100,50),html2canvas(e,{imageTimeout:2e3,removeContainer:!0,onrendered:function(e){var n=e.toDataURL("image/png");a.addImage(n,"JPEG",0,150,.4*e.width,.4*e.height),html2canvas(t,{imageTimeout:2e3,removeContainer:!0,onrendered:function(e){var t=e.toDataURL("image/png");a.addImage(t,"JPEG",50,75,.4*e.width,.4*e.height),a.setFontSize(24),a.text("Net Present Value: "+l,50,140),a.save("npv.pdf")}})}})}function printChecklist(){for(var e=new jsPDF("landscape"),t=$("#checklist_form").get(0),l=$("#checklist_form").clone(),a=1;20>=a;a++)$("[name="+a+"]").parent().html($("[name="+a+"]").val());var n={"#ignore":function(e,t){return console.log("ignore"),!0}};e.setFontSize(36),e.text("Project Checklist",100,25),e.fromHTML(t,40,50,{width:170,elementHandlers:n}),$("#checklist_form").html(l),e.output("dataurlnewwindow")}function cleanChecklist(){for(var e=1;20>=e;e++)$("input[name="+e+"]").val(""),$("select[name="+e+"]").val("0"),$("select[name="+e+"]").material_select();Materialize.toast("Form cleaned!",3e3)}function loadAllData(){for(var e=document.getElementById("pp-table-content"),t=(document.getElementById("npv-result"),'<div class="row  white-text red lighten-2 center-align"> <div class="col l2 md2"><h5> Period</h5></div><div class="col l3 md3"><h5> Outflow </h5></div><div class="col l3 md3"><h5> Inflow </h5></div><div class="col l4 md4"><h5> Cumulative Cash Flow</h5></div></div>');e.firstChild;)e.removeChild(e.firstChild);for(var l=select.options[select.selectedIndex].value,a=1;l>=a;a++)t+="<div class='row'><div class='col l2 md2'><h5 class='center-align'> "+a+"</h5></div><div class='col l3 md3'><input type='text' id='outflow"+a+"' placeholder='$0'></div><div class='col l3 md3'><input type='text' id='inflow"+a+"' placeholder='$0'></div><div class='col l4 md4'><input  type='text' id='cummulative"+a+"' value='$0' readonly></div></div>";e.innerHTML=t;for(var a=1;l>=a;a++)$("#outflow"+a).on("focusout",null,"outflow"+a,validateFlow),$("#inflow"+a).on("focusout",null,"inflow"+a,validateFlow)}function saveXlsx(){}$(document).ready(function(){$(".dropdown-button").dropdown(),$("select").material_select();var e=localStorage.getItem("project_name"),t=localStorage.getItem("evaluator");document.getElementById("project_name").innerHTML=e,document.getElementById("evaluator").innerHTML=t}),$(document).ready(function(){$("#Periodo").on("change","select",drawPaybackTable),$("#pp-principal").on("focusout",null,"pp-principal",validatePrincipal),$("#pp-interes").on("focusout",null,"pp-interes",validateInterest),$("#Calcular").on("click",calculate),$("#LDatos").on("click",Clear)}),$(document).ready(function(){$("#npv-periodo").on("change","select",drawNPVTable),$("#npv-Principal").on("focusout",null,"npv-Principal",validatePrincipal),$("#npv-Tax").on("focusout",null,"npv-Tax",validateInterest),$("#npv-Interes").on("focusout",null,"npv-Interes",validateInterest),$("#npv-Calcular").on("click",calculaNPV),$("#npv-LDatos").on("click",clean_npv)});